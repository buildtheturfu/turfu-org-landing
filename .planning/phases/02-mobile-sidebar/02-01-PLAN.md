---
phase: 02-mobile-sidebar
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - package-lock.json
  - src/components/content/MobileSidebarDrawer.tsx
  - src/app/[locale]/content/layout.tsx
autonomous: false

must_haves:
  truths:
    - "User sees hamburger button on mobile (below 768px) but not on desktop"
    - "User can tap hamburger to reveal sidebar as off-canvas drawer"
    - "User can tap backdrop or X button to close drawer"
    - "User cannot scroll page content while drawer is open"
  artifacts:
    - path: "src/components/content/MobileSidebarDrawer.tsx"
      provides: "Mobile drawer wrapper with hamburger button, animated panel, backdrop"
      min_lines: 80
      contains: "RemoveScroll"
    - path: "src/app/[locale]/content/layout.tsx"
      provides: "Layout integrating mobile drawer component"
      contains: "MobileSidebarDrawer"
  key_links:
    - from: "src/components/content/MobileSidebarDrawer.tsx"
      to: "react-remove-scroll"
      via: "RemoveScroll wrapper for scroll lock"
      pattern: "RemoveScroll"
    - from: "src/components/content/MobileSidebarDrawer.tsx"
      to: "framer-motion"
      via: "AnimatePresence for exit animations"
      pattern: "AnimatePresence"
    - from: "src/app/[locale]/content/layout.tsx"
      to: "MobileSidebarDrawer"
      via: "import and render"
      pattern: "MobileSidebarDrawer"
---

<objective>
Implement mobile sidebar navigation with hamburger menu, animated drawer, and body scroll locking.

Purpose: Enable mobile users to access documentation navigation that was hidden in Phase 1. Currently the sidebar is completely hidden on mobile with no way to navigate between articles.

Output: MobileSidebarDrawer component integrated into content layout, providing hamburger button, off-canvas drawer with backdrop, and scroll lock.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-mobile-sidebar/02-RESEARCH.md

# Existing files to reference
@src/components/content/ContentSidebar.tsx
@src/app/[locale]/content/layout.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install react-remove-scroll and create MobileSidebarDrawer component</name>
  <files>
    package.json
    package-lock.json
    src/components/content/MobileSidebarDrawer.tsx
  </files>
  <action>
1. Install react-remove-scroll:
   ```bash
   npm install react-remove-scroll
   ```

2. Create `src/components/content/MobileSidebarDrawer.tsx` with:
   - 'use client' directive (uses useState, framer-motion)
   - Props interface matching ContentSidebar: `{ articles: ArticleMeta[], categories: string[], locale: string }`
   - useState for `isOpen` boolean
   - Animation variants (from 02-RESEARCH.md):
     - backdropVariants: opacity 0 -> 1, exit with delay 0.1
     - panelVariants: x '-100%' -> 0, tween 0.3s easeOut, exit 0.2s easeIn
   - Hamburger button:
     - `md:hidden` (only visible on mobile)
     - `w-11 h-11` (44x44px touch target)
     - `rounded-lg bg-white/5 hover:bg-white/10`
     - Menu icon from lucide-react (size 24)
     - aria-label="Open navigation menu"
     - aria-expanded={isOpen}
     - aria-controls="mobile-sidebar"
   - AnimatePresence wrapping conditional render of drawer
   - RemoveScroll wrapper around backdrop + panel
   - Backdrop:
     - motion.div with backdropVariants
     - `fixed inset-0 bg-black/60 backdrop-blur-sm z-40 md:hidden`
     - onClick={() => setIsOpen(false)}
     - aria-hidden="true"
   - Drawer panel:
     - motion.aside with panelVariants
     - id="mobile-sidebar"
     - `fixed inset-y-0 left-0 w-72 bg-turfu-darker border-r border-white/10 z-50 md:hidden flex flex-col`
   - Drawer header with close button:
     - "Menu" title
     - Close button: `w-11 h-11`, X icon, aria-label="Close navigation menu"
   - Drawer content area:
     - `flex-1 overflow-y-auto`
     - Render the same navigation content as ContentSidebar:
       - Documentation header link
       - Search input (with clear button)
       - Home/All articles link
       - Categories (expandable with articles)
       - Uncategorized articles
       - No results state
       - Back to site footer link
     - Copy the exact navigation structure from ContentSidebar.tsx (lines 87-223) but without the outer aside tag and its classes
     - Include all the same state: search, expandedCategories
     - Include all the same helper logic: filtered, byCategory, uncategorized, isActive, isContentHome

Note: The drawer replicates ContentSidebar's inner content rather than wrapping it, because:
- ContentSidebar has `hidden md:flex` - cannot be shown inside drawer on mobile
- ContentSidebar has fixed height calculations that don't work in a drawer
- Drawer needs different container styles (overflow-y-auto without sticky positioning)
  </action>
  <verify>
    - `npm ls react-remove-scroll` shows version installed
    - File `src/components/content/MobileSidebarDrawer.tsx` exists
    - File contains RemoveScroll import from react-remove-scroll
    - File contains AnimatePresence import from framer-motion
    - File contains Menu and X imports from lucide-react
    - TypeScript compiles: `npx tsc --noEmit`
  </verify>
  <done>
    - react-remove-scroll is installed
    - MobileSidebarDrawer.tsx exists with hamburger button, animated drawer, backdrop, close button, and replicated sidebar navigation content
  </done>
</task>

<task type="auto">
  <name>Task 2: Integrate MobileSidebarDrawer into content layout</name>
  <files>
    src/app/[locale]/content/layout.tsx
  </files>
  <action>
Update `src/app/[locale]/content/layout.tsx`:

1. Add import:
   ```tsx
   import MobileSidebarDrawer from '@/components/content/MobileSidebarDrawer';
   ```

2. Add the mobile drawer component inside the flex container, positioned at top-left of content area:
   ```tsx
   <div className="flex min-h-screen pt-16 bg-turfu-dark overflow-x-hidden">
     <ContentSidebar
       articles={articles}
       categories={categories}
       locale={locale}
     />

     {/* Mobile hamburger button - fixed position below navbar */}
     <div className="md:hidden fixed top-20 left-4 z-30">
       <MobileSidebarDrawer
         articles={articles}
         categories={categories}
         locale={locale}
       />
     </div>

     <div className="flex-1 min-w-0">{children}</div>
   </div>
   ```

Notes:
- `top-20` = 80px (navbar is 64px + 16px gap)
- `left-4` = 16px from left edge
- `z-30` keeps button below backdrop (z-40) and drawer (z-50)
- `md:hidden` ensures button only shows on mobile
  </action>
  <verify>
    - `npm run build` succeeds
    - Layout file imports MobileSidebarDrawer
    - Layout file renders MobileSidebarDrawer with correct props
  </verify>
  <done>
    - MobileSidebarDrawer is integrated into content layout
    - Hamburger button appears at top-left on mobile only
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
    Complete mobile sidebar navigation system:
    - Hamburger button visible on mobile (below 768px)
    - Off-canvas drawer slides in from left with backdrop
    - Drawer contains full sidebar navigation (search, categories, articles)
    - Close via X button or backdrop tap
    - Body scroll locked while drawer open
  </what-built>
  <how-to-verify>
    1. Start dev server: `npm run dev`
    2. Open http://localhost:3000/fr/content in browser
    3. Open Chrome DevTools (F12) -> Toggle device toolbar (Ctrl+Shift+M)
    4. Select mobile viewport (e.g., iPhone 14 Pro, 393x852)

    **Test NAV-01 (Sidebar hidden on mobile):**
    - Verify desktop sidebar is NOT visible in mobile view
    - Verify hamburger button (three lines) appears at top-left

    **Test NAV-02 (Hamburger toggles sidebar):**
    - Tap hamburger button
    - Verify drawer slides in from left with smooth animation
    - Verify backdrop appears behind drawer (semi-transparent dark overlay)

    **Test NAV-03 (Close drawer):**
    - Tap X button in drawer header -> drawer should slide out
    - Reopen drawer, tap backdrop (dark area) -> drawer should close

    **Test NAV-04 (Scroll lock):**
    - Open drawer
    - Try to scroll the main page content (behind backdrop)
    - Verify page does NOT scroll
    - Scroll within the drawer (if content is long enough) -> drawer content SHOULD scroll

    **Test drawer functionality:**
    - Open drawer, type in search box -> articles should filter
    - Expand/collapse category sections
    - Tap an article link -> should navigate to article

    **Desktop verification:**
    - Resize to desktop width (> 768px)
    - Verify hamburger button is NOT visible
    - Verify original sidebar is visible and working
  </how-to-verify>
  <resume-signal>Type "approved" if all tests pass, or describe specific issues found</resume-signal>
</task>

</tasks>

<verification>
All success criteria from ROADMAP.md Phase 2:

1. User sees hamburger button on mobile (below md breakpoint) instead of sidebar
   - Hamburger visible on mobile: YES
   - Desktop sidebar still works: YES

2. User can tap hamburger to reveal sidebar as off-canvas drawer
   - Drawer opens with animation: YES
   - Drawer contains navigation content: YES

3. User can tap backdrop or X button to close drawer
   - X button closes: YES
   - Backdrop tap closes: YES
   - Smooth exit animation: YES

4. User cannot scroll page content while drawer is open
   - Body scroll locked: YES (via react-remove-scroll)
   - Drawer content scrollable: YES
</verification>

<success_criteria>
- [ ] react-remove-scroll installed (verify with `npm ls react-remove-scroll`)
- [ ] MobileSidebarDrawer.tsx exists with AnimatePresence, RemoveScroll, hamburger button
- [ ] Content layout imports and renders MobileSidebarDrawer
- [ ] Build passes: `npm run build`
- [ ] Human verification passes all NAV-01 through NAV-04 tests
</success_criteria>

<output>
After completion, create `.planning/phases/02-mobile-sidebar/02-01-SUMMARY.md`
</output>
